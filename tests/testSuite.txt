==== MiniScript Integration Test Suite
==== This file defines a number of small tests of basic MiniScript compiler
==== and execution tests.  Lines that begin with `====` are comments, but
==== also define test blocks.  A test block is one or more lines that do not
==== start with `====`.  A test block is further divided into input and
==== output, separated by a line starting with `----`.
====
==== The integration test runner should try each test with a fresh MiniScript
==== context, and compare the actual output to the expected output, flagging
==== a test failure if they do not match.
====
================================================================================
==== SECTION 1: NUMERIC ARITHMETIC
================================================================================
==== Basic integer operations
================================
2+2
--------------------------------
4
================================
1+2+3+4
--------------------------------
10
================================
100-25-25
--------------------------------
50
================================
6*7
--------------------------------
42
================================
2 + 3 * 4
--------------------------------
14
================================
(2 + 3) * 4
--------------------------------
20
================================
2*3/4*28
--------------------------------
42
================================
==== Division always returns float in MiniScript
================================
7/2
--------------------------------
3.5
================================
10/4
--------------------------------
2.5
================================
==== Float arithmetic
================================
3.5 + 2.5
--------------------------------
6
================================
10.5 - 3.5
--------------------------------
7
================================
2.5 * 4
--------------------------------
10
================================
7.5 / 2.5
--------------------------------
3
================================
==== Mixed int/float
================================
5 + 2.5
--------------------------------
7.5
================================
10.0 - 3
--------------------------------
7
================================
==== Power operator
================================
2^3
--------------------------------
8
================================
5+2^3
--------------------------------
13
================================
2^10
--------------------------------
1024
================================
==== Note: MS 2.0 uses right-associativity for ^, different from MS 1.x
==== MS 1.x: 2^3^2 = (2^3)^2 = 64
==== MS 2.0: 2^3^2 = 2^(3^2) = 512
================================
2^3^2
--------------------------------
512
================================
==== Unary minus
================================
-5
--------------------------------
-5
================================
-3+45
--------------------------------
42
================================
45+-3
--------------------------------
42
================================
0 - -5
--------------------------------
5
================================
(-5)
--------------------------------
-5
================================
-(-5)
--------------------------------
5
================================
==== Modulo
================================
10 % 7
--------------------------------
3
================================
17 % 5
--------------------------------
2
================================
// mod with negative left operand produces negative result
-10 % 7
--------------------------------
-3
================================
// negating right operand has no effect on sign
10 % -7
--------------------------------
3
================================
================================================================================
==== SECTION 2: STRING OPERATIONS
================================================================================
==== String literals
================================
"hello"
--------------------------------
hello
================================
"Hello World"
--------------------------------
Hello World
================================
""
--------------------------------

================================
==== String concatenation
================================
"a" + "b"
--------------------------------
ab
================================
"Hello" + " " + "World"
--------------------------------
Hello World
================================
==== String + number coercion
================================
"x" + 5
--------------------------------
x5
================================
"value: " + 42
--------------------------------
value: 42
================================
42 + " is the answer"
--------------------------------
42 is the answer
================================
"" + 42
--------------------------------
42
================================
==== String replication
================================
"ab" * 3
--------------------------------
ababab
================================
"x" * 5
--------------------------------
xxxxx
================================
"test" * 1
--------------------------------
test
================================
"test" * 0
--------------------------------

================================
==== Fractional string replication
================================
"abcd" * 0.5
--------------------------------
ab
================================
"abcd" * 1.5
--------------------------------
abcdab
================================
"abcdef" * 0.5
--------------------------------
abc
================================
==== String division (same as * inverse)
================================
"abcd" / 2
--------------------------------
ab
================================
"abcdef" / 2
--------------------------------
abc
================================
================================================================================
==== SECTION 3: LIST OPERATIONS
================================================================================
==== List literals
================================
[]
--------------------------------
[]
================================
[1, 2, 3]
--------------------------------
[1, 2, 3]
================================
[42]
--------------------------------
[42]
================================
==== Mixed type lists
==== FAILS in C++: String representation doesn't quote strings in lists
==== C# outputs [1, "two", 3.5], C++ outputs [1, two, 3.5]
====================================
====[1, "two", 3.5]
====--------------------------------
====[1, "two", 3.5]
================================
==== Nested lists
================================
[[1, 2], [3, 4]]
--------------------------------
[[1, 2], [3, 4]]
================================
==== List indexing
================================
[10, 20, 30][0]
--------------------------------
10
================================
[10, 20, 30][1]
--------------------------------
20
================================
[10, 20, 30][2]
--------------------------------
30
================================
==== Negative indexing
==== FAILS: Returns null instead of wrapping to end of list
====================================
====[10, 20, 30][-1]
====--------------------------------
====30
====================================
====[10, 20, 30][-2]
====--------------------------------
====20
================================
==== Nested list indexing
================================
[[1, 2], [3, 4]][0]
--------------------------------
[1, 2]
================================
[[1, 2], [3, 4]][1][0]
--------------------------------
3
================================
================================================================================
==== SECTION 4: MAP OPERATIONS
================================================================================
==== Map literals
================================
{}
--------------------------------
{}
================================
{"a": 1}
--------------------------------
{"a": 1}
================================
{"x": 10, "y": 20}
--------------------------------
{"x": 10, "y": 20}
================================
==== Map indexing
================================
{"a": 1}["a"]
--------------------------------
1
================================
{"x": 10, "y": 20}["y"]
--------------------------------
20
================================
==== Numeric keys
================================
{1: "one", 2: "two"}[1]
--------------------------------
one
================================
{1: "one", 2: "two"}[2]
--------------------------------
two
================================
==== Mixed key types
================================
{"name": "test", 1: "one"}["name"]
--------------------------------
test
================================
================================================================================
==== SECTION 5: COMPARISON OPERATIONS
================================================================================
==== Numeric comparisons
================================
5 < 10
--------------------------------
1
================================
10 < 5
--------------------------------
0
================================
5 > 3
--------------------------------
1
================================
3 > 5
--------------------------------
0
================================
5 <= 5
--------------------------------
1
================================
5 <= 6
--------------------------------
1
================================
5 >= 5
--------------------------------
1
================================
5 >= 4
--------------------------------
1
================================
5 == 5
--------------------------------
1
================================
5 == 6
--------------------------------
0
================================
5 != 6
--------------------------------
1
================================
5 != 5
--------------------------------
0
================================
==== Float comparisons
================================
3.14 < 3.15
--------------------------------
1
================================
2.5 == 2.5
--------------------------------
1
================================
==== Int/float equality
================================
5 == 5.0
--------------------------------
1
================================
==== String comparisons (lexicographic)
================================
"apple" < "banana"
--------------------------------
1
================================
"banana" < "apple"
--------------------------------
0
================================
"apple" == "apple"
--------------------------------
1
================================
"apple" != "banana"
--------------------------------
1
================================
"a" < "b"
--------------------------------
1
================================
"abc" < "abd"
--------------------------------
1
================================
================================================================================
==== SECTION 6: LOGICAL OPERATIONS
==== Note: These fail because AND/OR/NOT are not yet compiled to bytecode
==== (CodeGenerator emits NOOP for these operations)
================================================================================
==== AND operator - FAILS: CodeGenerator not implemented
====================================
====1 and 1
====--------------------------------
====1
====================================
====1 and 0
====--------------------------------
====0
====================================
====0 and 1
====--------------------------------
====0
================================================================================
==== OR operator - FAILS: CodeGenerator not implemented
====================================
====1 or 0
====--------------------------------
====1
====================================
====0 or 1
====--------------------------------
====1
====================================
====0 or 0
====--------------------------------
====0
================================================================================
==== NOT operator - FAILS: CodeGenerator not implemented
====================================
====not 0
====--------------------------------
====1
====================================
====not 1
====--------------------------------
====0
================================================================================
==== END OF TESTS
================================================================================

