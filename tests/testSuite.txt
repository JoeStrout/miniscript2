==== MiniScript Integration Test Suite
==== This file defines a number of small tests of basic MiniScript compiler
==== and execution tests.  Lines that begin with `====` are comments, but
==== also define test blocks.  A test block is one or more lines that do not
==== start with `====`.  A test block is further divided into input and
==== output, separated by a line starting with `----`.
====
==== The integration test runner should try each test with a fresh MiniScript
==== context, and compare the actual print output to the expected output,
==== flagging a test failure if they do not match.
====
================================================================================
==== SECTION 0: BASIC STATEMENT/COMMENT PARSING
================================================================================
print 42
--------------------------------
42
================================
// Here is a comment all on its own line.
print 123  // and here is a comment after a statement
// Followed by another full-line comment.
--------------------------------
123
================================
// several statements separated by semicolons:
print 1; print 2; print 3
print 4 // however; a semicolon in a comment; does nothing
print 5
--------------------------------
1
2
3
4
5
================================================================================
==== SECTION 1: NUMERIC ARITHMETIC
================================================================================
==== Basic integer operations
================================
print 2+2
--------------------------------
4
================================
print 1+2+3+4
--------------------------------
10
================================
print 100-25-25
--------------------------------
50
================================
print 6*7
--------------------------------
42
================================
print 2 + 3 * 4
--------------------------------
14
================================
print (2 + 3) * 4
--------------------------------
20
================================
print 2*3/4*28
--------------------------------
42
================================
==== Division always returns float in MiniScript
================================
print 7/2
--------------------------------
3.5
================================
print 10/4
--------------------------------
2.5
================================
==== Float arithmetic
================================
print 3.5 + 2.5
--------------------------------
6
================================
print 10.5 - 3.5
--------------------------------
7
================================
print 2.5 * 4
--------------------------------
10
================================
print 7.5 / 2.5
--------------------------------
3
================================
==== Mixed int/float
================================
print 5 + 2.5
print 10.0 - 3
--------------------------------
7.5
7
================================
==== Power operator
================================
print 2^3
--------------------------------
8
================================
print 5+2^3
--------------------------------
13
================================
print 2^10
--------------------------------
1024
================================
print -2^3 // ^ has higher precedence than -
--------------------------------
-8
================================
==== Note: MS 2.0 uses right-associativity for ^, different from MS 1.x
==== MS 1.x: 2^3^2 = (2^3)^2 = 64
==== MS 2.0: 2^3^2 = 2^(3^2) = 512
================================
print 2^3^2
--------------------------------
512
================================
==== Unary minus (see UNARY_MINUS_QUIRK.md)
================================
print -5
--------------------------------
-5
================================
print -3+45
--------------------------------
42
================================
print 45+-3
--------------------------------
42
================================
print 0 - -5
--------------------------------
5
================================
print (-5)
--------------------------------
-5
================================
print -(-5)
--------------------------------
5
================================
==== Modulo
================================
print 10 % 7
--------------------------------
3
================================
print 17 % 5
--------------------------------
2
================================
// mod with negative left operand produces negative result
print -10 % 7
--------------------------------
-3
================================
// negating right operand has no effect on sign
print 10 % -7
--------------------------------
3
================================
================================================================================
==== SECTION 2: STRING OPERATIONS
================================================================================
==== String literals
================================
print "hello"
--------------------------------
hello
================================
print "Hello World"
--------------------------------
Hello World
================================
print ""
--------------------------------

================================
==== String concatenation
================================
print "a" + "b"
--------------------------------
ab
================================
print "Hello" + " " + "World"
--------------------------------
Hello World
================================
==== String + number coercion
================================
print "x" + 5
--------------------------------
x5
================================
print "value: " + 42
--------------------------------
value: 42
================================
print 42 + " is the answer"
--------------------------------
42 is the answer
================================
print "" + 42
--------------------------------
42
================================
==== String replication
================================
print "ab" * 3
--------------------------------
ababab
================================
print "x" * 5
--------------------------------
xxxxx
================================
print "test" * 1
--------------------------------
test
================================
print "test" * 0
--------------------------------

================================
==== Fractional string replication
================================
print "abcd" * 0.5
--------------------------------
ab
================================
print "abcd" * 1.5
--------------------------------
abcdab
================================
print "abcdef" * 0.5
--------------------------------
abc
================================
==== String division (same as * inverse)
================================
print "abcd" / 2
--------------------------------
ab
================================
print "abcdef" / 2
--------------------------------
abc
================================
================================================================================
==== SECTION 3: LIST OPERATIONS
================================================================================
==== List literals
================================
print []
--------------------------------
[]
================================
print [1, 2, 3]
--------------------------------
[1, 2, 3]
================================
print [42]
--------------------------------
[42]
================================
==== Mixed type lists
====================================
print [1, "two", 3.5]
--------------------------------
[1, "two", 3.5]
================================
==== Nested lists
================================
print [[1, 2], [3, 4]]
--------------------------------
[[1, 2], [3, 4]]
================================
==== List indexing
================================
print [10, 20, 30][0]
--------------------------------
10
================================
print [10, 20, 30][1]
--------------------------------
20
================================
print [10, 20, 30][2]
--------------------------------
30
================================
==== Negative indexing
====================================
print [10, 20, 30][-1]
print [10, 20, 30][-2]
--------------------------------
30
20
================================
==== Nested list indexing
================================
print [[1, 2], [3, 4]][0]
--------------------------------
[1, 2]
================================
print [[1, 2], [3, 4]][1][0]
--------------------------------
3
================================
================================================================================
==== SECTION 4: MAP OPERATIONS
================================================================================
==== Map literals
================================
print {}
--------------------------------
{}
================================
print {"a": 1}
--------------------------------
{"a": 1}
================================
print {"x": 10, "y": 20}
--------------------------------
{"x": 10, "y": 20}
================================
==== Map indexing
================================
print {"a": 1}["a"]
--------------------------------
1
================================
print {"x": 10, "y": 20}["y"]
--------------------------------
20
================================
==== Numeric keys
================================
print {1: "one", 2: "two"}[1]
--------------------------------
one
================================
print {1: "one", 2: "two"}[2]
--------------------------------
two
================================
==== Mixed key types
================================
print {"name": "test", 1: "one"}["name"]
--------------------------------
test
================================
================================================================================
==== SECTION 5: COMPARISON OPERATIONS
================================================================================
==== Numeric comparisons
================================
print 5 < 10
--------------------------------
1
================================
print 10 < 5
--------------------------------
0
================================
print 5 > 3
--------------------------------
1
================================
print 3 > 5
--------------------------------
0
================================
print 5 <= 5
--------------------------------
1
================================
print 5 <= 6
--------------------------------
1
================================
print 5 >= 5
--------------------------------
1
================================
print 5 >= 4
--------------------------------
1
================================
print 5 == 5
--------------------------------
1
================================
print 5 == 6
--------------------------------
0
================================
print 5 != 6
--------------------------------
1
================================
print 5 != 5
--------------------------------
0
================================
==== Float comparisons
================================
print 3.14 < 3.15
--------------------------------
1
================================
print 2.5 == 2.5
--------------------------------
1
================================
==== Int/float equality
================================
print 5 == 5.0
--------------------------------
1
================================
==== String comparisons (lexicographic)
================================
print "apple" < "banana"
--------------------------------
1
================================
print "banana" < "apple"
--------------------------------
0
================================
print "apple" == "apple"
--------------------------------
1
================================
print "apple" != "banana"
--------------------------------
1
================================
print "a" < "b"
--------------------------------
1
================================
print "abc" < "abd"
--------------------------------
1
================================
================================================================================
==== SECTION 6: LOGICAL OPERATIONS
================================================================================
==== AND operator
====================================
print 1 and 1
--------------------------------
1
====================================
print 1 and 0
--------------------------------
0
====================================
print 0 and 1
--------------------------------
0
====================================
print 0.5 and 1
--------------------------------
0.5
====================================
print 0.5 and 0.5
--------------------------------
0.25
====================================
print 0.5 and -0.5
--------------------------------
0.25
====================================
print 1.5 and 0.5
--------------------------------
0.75
====================================
print -0.5 and -0.5
--------------------------------
0.25
================================================================================
==== OR operator
====================================
print 1 or 0
--------------------------------
1
====================================
print 0 or 1
--------------------------------
1
====================================
print 0 or 0
--------------------------------
0
====================================
print 0.5 or 1
--------------------------------
1
====================================
print 0.5 or 0.5
--------------------------------
0.75
====================================
print -0.1 or -0.5
--------------------------------
0.65
====================================
print -0.5 or 0.5
--------------------------------
0.25
================================================================================
==== NOT operator
====================================
print not 0
--------------------------------
1
====================================
print not 1
--------------------------------
0
====================================
print not 0.25
--------------------------------
0.75
====================================
print not -0.1
--------------------------------
0.9
====================================
print not 42
--------------------------------
0
================================================================================
==== SECTION 7: MULTI-LINE TESTS
================================================================================
==== Multiple print statements
================================
print "Hello"
print "World"
--------------------------------
Hello
World
================================
print 1
print 2
print 3
--------------------------------
1
2
3
================================
================================================================================
==== SECTION 8: VARIABLE TESTS
================================================================================
==== Basic variable assignment and read
================================
x = 42
print x
--------------------------------
42
================================
x = "hello"
print x
--------------------------------
hello
================================
==== Multiple variables
================================
x = 10
y = 20
print x + y
--------------------------------
30
================================
a = 5
b = 3
c = a * b
print c
--------------------------------
15
================================
==== Variable reassignment
================================
x = 1
print x
x = 2
print x
x = 3
print x
--------------------------------
1
2
3
================================
x = 10
x = x + 5
print x
--------------------------------
15
================================
x = 2
x = x * x
print x
--------------------------------
4
================================
==== Variables in expressions
================================
x = 6
y = 7
print x * y
--------------------------------
42
================================
a = 100
b = 58
print a - b
--------------------------------
42
================================
x = 10
y = 4
print x / y + x % y
--------------------------------
4.5
================================
==== Variables with different types
================================
n = 42
s = "answer"
print s + ": " + n
--------------------------------
answer: 42
================================
x = 3.14159
print x * 2
--------------------------------
6.28318
================================
==== Variables in comparisons
================================
x = 5
y = 10
print x < y
--------------------------------
1
================================
a = 42
b = 42
print a == b
--------------------------------
1
================================
==== Variables in logical operations
================================
x = 1
y = 0
print x and y
--------------------------------
0
================================
x = 0
y = 1
print x or y
--------------------------------
1
================================
==== Variables with lists
================================
x = [1, 2, 3]
print x
--------------------------------
[1, 2, 3]
================================
x = [10, 20, 30]
print x[1]
--------------------------------
20
================================
==== Variables with maps
================================
m = {"x": 10}
print m
--------------------------------
{"x": 10}
================================
m = {"a": 1, "b": 2}
print m["a"]
print m["b"]
--------------------------------
1
2
================================
==== END OF TESTS
================================================================================

